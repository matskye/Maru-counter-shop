<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Maru's Counter Shop</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <h1>Maru's Counter Shop</h1>
      <p class="subtitle">Master Japanese counters with Maru!</p>
    </header>

    <main id="game" class="game-panel">
      <div class="drawer-launchers" role="group" aria-label="Counter tools">
        <button
          type="button"
          class="drawer-launcher"
          data-drawer-toggle="clock"
          aria-controls="clockDrawer"
          aria-expanded="false"
          title="Open clock counter"
        >🕒</button>
        <button
          type="button"
          class="drawer-launcher"
          data-drawer-toggle="calendar"
          aria-controls="calendarDrawer"
          aria-expanded="false"
          title="Open calendar counter"
        >📅</button>
      </div>
      <section class="customer-card">
        <div id="customer" class="speech-bubble">「---」</div>
        <button id="replayVoiceBtn" class="ghost inline">🔁 Replay audio</button>
        <div id="maruReaction" class="reaction"></div>
        <div id="feedback" class="feedback" aria-live="polite"></div>
        <button id="toggleHintBtn" class="ghost inline" aria-expanded="false" aria-controls="counterHint">💡 Show hint</button>
        <div id="counterHint" class="hint-window"></div>
      </section>

      <section class="status-bar" aria-live="polite">
        <div class="status-chip" id="modeStatus">Practice mode</div>
        <div class="status-chip" id="challengeStatus" hidden>
          <span>Round <span id="challengeRound">1</span> / 10</span>
          <span aria-hidden="true">·</span>
          <span>Score <span id="challengeScore">0</span></span>
        </div>
        <div class="status-chip" id="streakStatus">Current streak: <span id="streakCount">0</span></div>
      </section>

      <section class="play-area">
        <div class="panel">
          <h2 class="section-title">Shelf</h2>
          <div id="shelf" class="shelf-grid"></div>
        </div>

        <div class="panel">
          <h2 class="section-title">Counter</h2>
          <div id="counter" class="dropzone">
            <span class="drop-hint">Drag or click items to add</span>
          </div>
        </div>
      </section>

      <section id="controls" class="controls">
        <button id="doneBtn" class="primary">Done!</button>
        <button id="startPractice">Practice Mode</button>
        <button id="startChallenge">Challenge Mode</button>
        <button id="settingsBtn" class="ghost">⚙️ Settings</button>
      </section>

      <section class="learn-more">
        <details id="howToPlay">
          <summary>How to play &amp; study tips</summary>
          <ol>
            <li>Listen to Maru&rsquo;s request or read the speech bubble.</li>
            <li>Drag or click items from the shelf that match the counter being used.</li>
            <li>Use the <em>Done!</em> button to check your answer and keep your streak going.</li>
          </ol>
          <p>
            Need a hand? Toggle the hint to learn what a counter is used for, or replay the voice prompt as many times as
            you like. Challenge mode runs for ten rounds&mdash;aim for a perfect score!
          </p>
        </details>
      </section>
    </main>
  </div>

  <!-- Settings modal -->
  <div id="settingsModal" class="modal">
    <div class="modal-content">
      <h2>Settings</h2>
      <label>
        <input type="checkbox" id="furiganaCheckbox"> Show Furigana
      </label>
      <br>
      <label>
        <input type="checkbox" id="voiceCheckbox"> Enable Voice
      </label>
      <br><br>
      <button id="openCounterPage" class="ghost">Manage counters</button>
      <br><br>
      <button id="closeSettings">Close</button>
    </div>
  </div>

  <div id="counterPage" class="modal">
    <div class="modal-content counter-modal" role="dialog" aria-modal="true" aria-labelledby="counterPageTitle">
      <header class="counter-modal__header">
        <h2 id="counterPageTitle">Counter preferences</h2>
        <p>Select which counters appear in practice and review your accuracy.</p>
      </header>
      <div id="counterSummary" class="counter-summary"></div>
      <div id="counterList" class="counter-list" role="list"></div>
      <div class="counter-modal__actions">
        <button id="selectAllCounters" class="ghost">Select all counters</button>
        <button id="closeCounterPage">Done</button>
      </div>
    </div>
  </div>

  <div id="drawerOverlay" class="drawer-overlay" hidden></div>
  <aside id="drawerContainer" class="drawer-container" aria-hidden="true">
    <div id="clockDrawer" class="drawer-panel clock-drawer" data-drawer="clock" hidden>
      <header class="drawer-header">
        <h2 class="drawer-title">Clock counter</h2>
        <p class="drawer-subtitle">Drag each hand to set the time requested.</p>
      </header>
      <div class="clock-face-wrapper">
        <div class="clock-face" id="clockFace" role="presentation">
          <div id="clockMarkers" class="clock-markers" aria-hidden="true"></div>
          <div class="clock-hand hour-hand" data-hand="hours" aria-label="Hour hand" role="slider" aria-valuemin="0" aria-valuemax="11" aria-valuenow="0"></div>
          <div class="clock-hand minute-hand" data-hand="minutes" aria-label="Minute hand" role="slider" aria-valuemin="0" aria-valuemax="59" aria-valuenow="0"></div>
          <div class="clock-hand second-hand" data-hand="seconds" aria-label="Second hand" role="slider" aria-valuemin="0" aria-valuemax="59" aria-valuenow="0"></div>
          <div class="clock-center" aria-hidden="true"></div>
        </div>
        <input
          id="clockValue"
          class="clock-value"
          type="text"
          aria-live="polite"
          aria-label="Selected time"
          autocomplete="off"
          spellcheck="false"
          value="00:00:00"
        />
      </div>
      <div class="drawer-actions">
        <button id="clockDoneBtn" type="button" class="primary">✅ Done</button>
      </div>
    </div>

    <div id="calendarDrawer" class="drawer-panel calendar-drawer" data-drawer="calendar" hidden>
      <header class="drawer-header">
        <h2 class="drawer-title">Calendar counter</h2>
      </header>
      <div class="calendar-meta">
        <div class="calendar-info">
          <p id="calendarModeLabel" class="drawer-subtitle"></p>
          <span id="calendarTarget" class="calendar-target"></span>
        </div>
        <div class="calendar-controls">
          <button id="calendarTearBtn" type="button" class="ghost">🗓️ Tear off page</button>
          <span id="calendarSelectionCount" class="calendar-count" aria-live="polite">Marked: 0</span>
        </div>
      </div>
      <div id="calendarGrid" class="calendar-grid" aria-live="polite"></div>
      <div class="drawer-actions">
        <button id="calendarDoneBtn" type="button" class="primary">✅ Done</button>
      </div>
    </div>
  </aside>

  <script src="game.js"></script>
</body>
</html>
